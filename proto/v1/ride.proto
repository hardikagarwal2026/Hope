syntax = "proto3";

package proto.v1;

option go_package = "./proto/v1/ride";

import "google/protobuf/timestamp.proto";

message RideOffer {
  string id = 1;
  string driver_id = 2;
  string from_geo = 3;
  string to_geo = 4;
  double fare = 5;
  google.protobuf.Timestamp time = 6;
  int32 seats = 7;
  string status = 8;
}

message RideRequest {
  string id = 1;
  string user_id = 2;
  string from_geo = 3;
  string to_geo = 4;
  google.protobuf.Timestamp time = 5;
  int32 seats = 6;
  string status = 7;
}

service RideService {
  rpc CreateOffer (CreateOfferRequest) returns (CreateOfferResponse) {}
  rpc GetOffer (GetOfferRequest) returns (GetOfferResponse) {}
  rpc UpdateOffer (UpdateOfferRequest) returns (UpdateOfferResponse) {}
  rpc DeleteOffer (DeleteOfferRequest) returns (DeleteOfferResponse) {}
  rpc ListNearbyOffers (ListNearbyOffersRequest) returns (ListNearbyOffersResponse) {}
  rpc ListMyOffers (ListMyOffersRequest) returns (ListMyOffersResponse) {}

  rpc CreateRequest (CreateRequestRequest) returns (CreateRequestResponse) {}
  rpc GetRequest (GetRequestRequest) returns (GetRequestResponse) {}
  rpc UpdateRequestStatus (UpdateRequestStatusRequest) returns (UpdateRequestStatusResponse) {}
  rpc DeleteRequest (DeleteRequestRequest) returns (DeleteRequestResponse) {}
  rpc ListNearbyRequests (ListNearbyRequestsRequest) returns (ListNearbyRequestsResponse) {}
  rpc ListMyRequests (ListMyRequestsRequest) returns (ListMyRequestsResponse) {}
}

message CreateOfferRequest {
  string from_geo = 1;
  string to_geo = 2;
  double fare = 3;
  google.protobuf.Timestamp time = 4;
  int32 seats = 5;
}
message CreateOfferResponse {
  RideOffer offer = 1;
}

message GetOfferRequest {
  string id = 1;
}
message GetOfferResponse {
  RideOffer offer = 1;
}

message UpdateOfferRequest {
  string id = 1;
  double fare = 2;
  int32 seats = 3;
  string status = 4;
}
message UpdateOfferResponse {
  RideOffer offer = 1;
}

message DeleteOfferRequest {
  string id = 1;
}
message DeleteOfferResponse {
  bool success = 1;
}

message ListNearbyOffersRequest {
  string geohash_prefix = 1;
  int32 limit = 2;
}
message ListNearbyOffersResponse {
  repeated RideOffer offers = 1;
}

message ListMyOffersRequest {
  int32 limit = 1;
}
message ListMyOffersResponse {
  repeated RideOffer offers = 1;
}

message CreateRequestRequest {
  string from_geo = 1;
  string to_geo = 2;
  google.protobuf.Timestamp time = 3;
  int32 seats = 4;
  string status = 5;
}
message CreateRequestResponse {
  RideRequest request = 1;
}

message GetRequestRequest {
  string id = 1;
}
message GetRequestResponse {
  RideRequest request = 1;
}

message UpdateRequestStatusRequest {
  string id = 1;
  string status = 2;
}
message UpdateRequestStatusResponse {
  RideRequest request = 1;
}

message DeleteRequestRequest {
  string id = 1;
}
message DeleteRequestResponse {
  bool success = 1;
}

message ListNearbyRequestsRequest {
  string geohash_prefix = 1;
  int32 limit = 2;
}
message ListNearbyRequestsResponse {
  repeated RideRequest requests = 1;
}

message ListMyRequestsRequest {
  int32 limit = 1;
}
message ListMyRequestsResponse {
  repeated RideRequest requests = 1;
}
